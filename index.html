<!DOCTYPE html>



<!-- TODO:
  * My assistant data scientist *
 Create a super minimal, simple little app that does the following:
    - Presents an svg graph that the user can add points to by clicking
    - Have them click a button to fit a linear regression through the points
    - Make the regression line look really beautiful. Have it change slope after
      a click look really cool.
    - Plot the regression coefficients if you really feel like it
-->


<html>
  <head>
    <meta charset="utf-8">
    <title>Kyle Johnson</title>
    <link href="https://fonts.googleapis.com/css?family=Frank+Ruhl+Libre:300,400" rel="stylesheet">
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
    <style media="screen">
      body {
        font-family: 'Frank Ruhl Libre', sans-serif;
      }
      #main {
        font-size: 20px;
        margin: 5% 10%;
      }
      div#main_paragraph {
        margin: 3% 0 0 0;
        text-shadow: 1px 1px 2px #EEE;
      }
      a {
        color: #596386;
        text-decoration: none;
      }
      img#photo_img {
        height: 200px;
        width: auto;
        border-radius: 100px;
        box-shadow: 0px 0px 5px #333;
      }
      div#links ul li {
        text-decoration: none;
        display: inline;
      }
      div#links ul li:after {
        content: " | ";
        color: #596386;
      }
      div#links ul li:last-child:after {
        content: none;
      }
      div#links ul li a {
        text-decoration: none;
      }
    </style>
  </head>
  <body>
    <div id="main">
      <div id="photo" align="center">
        <img src="img/main_photo.jpg" alt="kyle_photo" id="photo_img">
      </div>
      <div align="center">
        <button type="button" id="show_button">Click Me</button>
      </div>
      <div id="plotter_section" align="center">
        <p></p>
      </div>
      <div id="main_text">
        <p>
          I'm Kyle Johnson, a data scientist and undergraduate at Columbia University.
          I'm interested in machine learning, natural language processing, data
          visualization, and quantitative social science broadly.
        </p>
        <p>I'm a data science intern at Facebook.</p>
        <p>I'm a machine learning engineer and research assistant in the
        <a href="http://www.columbia.edu/cu/psychology/vpvaughns/">
          Laboratory for Intergroup Relations and the Social Mind.</a>
        </p>
        <p>My hobbies include running, reading, and
        <a href="http://www.columbia.edu/cu/jiujitsu/">
          Brazilian jiu-jitsu
        </a>.</p>
        <p>Feel free to reach out via
          <a href="mailto:gkjohns@gmail.com">email</a>,
           I'm always up for ☕️.</p>
      </div>
      <div id="links" align="center">
        <ul>
          <li><a href="GKyleJohnsonResume.pdf">Resume</a></li>
          <li><a href="https://www.linkedin.com/in/gkjohns">Linkedin</a></li>
          <li><a href="https://github.com/GKjohns">Github</a></li>
          <li><a href="https://www.kaggle.com/gkjohns">Kaggle</a></li>
        </ul>
      </div>
    </div>
  </body>
  <script>

    // Hide everything
    $("#photo_img").hide();
    $("div#plotter_section").hide();
    $("#main_text").hide();
    $("#links").hide();

    /* make this smooth because its clunky right now */
    var plotterShowing = false;
    $("#show_button").click(function() {
      $("div#plotter_section").slideToggle(700);
    })


    // Fade everything in
    var showAfterLoad = function(fade_time) {
      $("#photo_img").fadeIn(fade_time);
      $("#main_text").delay(fade_time).fadeIn(fade_time);
      $("#links").delay(2 * fade_time).fadeIn(fade_time);
    }

    // Do things after the image has loaded (it's big)
    $(window).on("load", function() {
      showAfterLoad(300);
    });

    var svg = d3.select("div#plotter_section").selectAll("p")
                .append("p")
                .text("Big old beautiful plot here");

    var dataset = [
      [ 36.59,  30.62],
      [ 45.6 ,  45.75],
      [ 20.5 ,  25.7 ],
      [  1.36,   8.44],
      [ 22.33,  24.06],
      [ 48.89,  50.92],
      [ 11.51,  18.05],
      [ 25.96,  26.82],
      [ 47.17,  44.98],
      [ 11.03,  18.44],
      [ 42.34,  42.16],
      [ 36.15,  34.58],
      [ 19.93,  24.93],
      [ 32.9 ,  32.02],
      [ 12.66,  22.89],
      [  2.46,   9.05],
      [ 25.66,  26.76],
      [ 41.71,  35.93],
      [ 26.54,  33.8 ],
      [ 35.09,  32.4 ],
      [  5.93,   5.73],
      [ 21.98,  21.95],
      [ 42.78,  41.92],
      [ 19.55,  20.3 ],
      [ 27.77,  27.51],
      [ 34.29,  34.99],
      [ 26.15,  28.76],
      [ 23.1 ,  25.94],
      [  6.36,  15.  ],
      [  2.68,   9.68],
      [ 24.83,  28.96],
      [ 30.82,  31.3 ],
      [ 20.05,  18.01],
      [ 11.76,  10.8 ],
      [ 44.62,  42.66],
      [ 37.94,  40.38],
      [ 37.05,  34.03],
      [  4.1 ,   9.23],
      [  6.41,  10.75],
      [  5.65,   6.34],
      [ 20.04,  18.34],
      [ 30.66,  33.48],
      [ 19.  ,  27.49],
      [  8.48,  16.91],
      [ 23.25,  17.64],
      [ 23.28,  31.05],
      [ 14.49,  12.01],
      [ 16.54,  23.57],
      [ 19.05,  22.5 ],
      [ 44.03,  45.81]
    ];

    var width = 500,
        height = 350,
        xPadding = 30,
        yPadding = 30,
        xLow = xPadding,
        xHigh = (width - xPadding),
        yLow = (height - yPadding),
        yHigh = yPadding;

    var svg = d3.selectAll("div#plotter_section")
                .append("svg")
                .attr("width", width)
                .attr("height", height);

    var xScale = d3.scaleLinear()
                   .domain([0, d3.max(dataset, function(d) { return d[0]; })])
                   .range([xLow, xHigh]);

    var yScale = d3.scaleLinear()
                   .domain([0, d3.max(dataset, function(d) { return d[1]; })])
                   .range([yLow, yHigh]);   // reversed

    var xAxis = d3.axisBottom(xScale);
    var yAxis = d3.axisRight(yScale);

    svg.selectAll("circle")
       .data(dataset)
       .enter()
       .append("circle")
       .attr("cx", function(d) {
         return xScale(d[0]);
       })
       .attr("cy", function(d) {
         return yScale(d[1]);
       })
       .attr("r", 10)
       .attr("fill", "#596386")
       .attr("stroke", "white");

    svg.append("line")
       .attr("x1", function() {
         return xScale(0);
       })
       .attr("y1", function() {
         return yScale((getRegressionParams(dataset)[0]));
       })
       .attr("x2", function() {
         return xScale(1000);
       })
       .attr("y2", function() {
         console.log(xHigh);
         return yScale((getRegressionParams(dataset)[1] * 1000));
       })
       .attr("stroke-width", 5)
       .attr("stroke", "#993333");

    function getRegressionParams(data) {
      // calculate average x and y
      var sumX = 0,
          sumY = 0
          sxx = 0,
          sxy = 0,
          n = data.length;
      for (var i = 0; i < data.length; i++) {
        sumX += data[i][0];
        sumY += data[i][1];
      }
      var xBar = sumX / n;
      var yBar = sumY / n;

      // get terms for beta0 and beta1
      for (var i = 0; i < data.length; i++) {
        sxx += Math.pow((data[i][0] - xBar), 2)
        sxy += (data[i][0] - xBar) * (data[i][1] - yBar);
      }

      beta1 = sxy / sxx;
      beta0 = yBar - (beta1 * xBar);

      return [beta0, beta1];
    }

    console.log(getRegressionParams(dataset));


  </script>
</html>
